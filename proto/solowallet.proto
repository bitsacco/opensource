syntax = "proto3";

import "lib.proto";
import "swap.proto";
import "lightning.proto";

package solowallet;

service SolowalletService {
  rpc DepositFunds(DepositFundsRequest) returns (DepositFundsResponse){}

  rpc FindUserDeposits(FindUserTxsRequest) returns (PaginatedSolowalletTxsResponse){}
}

message DepositFundsRequest {
  string user_id = 1;

  int32 amount_fiat = 2;

  string reference = 3;

  optional swap.OnrampSwapSource onramp = 5;

  // Add more otional funding sources, like direct lightning deposit
}

message DepositFundsResponse {
  string tx_id = 1;
  PaginatedSolowalletTxsResponse deposits = 2;
}

message SolowalletTx {
  string id = 1;

  string user_id = 2;

  lib.TransactionStatus status = 3;

  int32 amount_msats = 4;

  optional int32 amount_fiat = 5;

  lightning.Bolt11 lightning = 6;

  reserved 7, 8, 9;

  string reference = 10;

  string createdAt = 11;

  optional string updatedAt = 12;
}

message FindUserTxsRequest {
  string user_id = 1;
  lib.PaginatedRequest pagination = 2;
}

message PaginatedSolowalletTxsResponse {
  // List of onramp swaps
  repeated SolowalletTx transactions = 1;
  // Current page offset
  int32 page = 2;
  // Number of items return per page
  int32 size = 3;
  // Number of pages given the current page size
  int32 pages = 4;
}
